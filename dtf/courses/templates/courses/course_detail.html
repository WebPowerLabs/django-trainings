{% extends 'courses/base.html' %}
{% load crispy_forms_tags thumbnail %}
{% block content %}
<div class="container">
    {% if user.is_staff %}
    <div class="row">
        <div class="panel-group" id="accordion">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                            Edit Course
                        </a>
                        <a href="{% url 'lessons:add' object.slug %}" class="pull-right">Add Lesson</a>
                    </h4>
                </div>
                <div id="collapseOne" class="panel-collapse collapse">
                    <div class="panel-body">
                        <a class='btn btn-danger' href='{% url "courses:delete" object.slug %}'>Delete</a>
                        {% crispy form %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    <div class="row">
        <div class="col-md-5">
            <div class="row">
                {% thumbnail object.thumbnail '480x304' crop='center' as im %}
                <img src="{{ im.url }}" class="img-rounded" alt="{{ object.name }}">
                {% endthumbnail %}
            </div>
            <div class="row">
                <h2>{{ object.name }}</h2>                
            </div>
            <div class="row">
                <p>{{ object.description }}</p>                
            </div>
        </div>
        <div class="col-md-7 {% if user.is_staff %}sortable{% endif %}" data-url="{% url 'lessons:order' object.pk %}">
            {% for lesson in lesson_list %}
            <a href="{% url 'lessons:detail' lesson.slug %}?course={{ lesson.course_id }}" class="no_transition sortable_item pull-left" data-pk="{{ lesson.pk }}">
                <div class="alert alert-info">
                    <div class="row">
                        <div class="col-md-3">
                            {% thumbnail lesson.thumbnail '122x117' crop='center' as im %}
                                <img src="{{ im.url }}" class="img-rounded" alt="{{ lesson.name }}">
                            {% endthumbnail %}
                        </div>
                        <div class="col-md-9">
                            <h2>{{ lesson.name }}</h2>
                            <span>{{ lesson.description|truncatewords:25 }}</span>
                        </div>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock content %}
